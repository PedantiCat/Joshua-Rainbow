<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Programming Project - Joshua Rainbow</title><meta name="gridsome:hash" content="6bfe371befdc3834c5992983ffb52a373778e768"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.13"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Cutive+Mono&amp;display=swap"><link rel="preload" href="/assets/css/0.styles.d56c1449.css" as="style"><link rel="preload" href="/assets/js/app.9b9312ea.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--programming-vue.c0a9bcf3.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.28b41598.js"><link rel="prefetch" href="/assets/js/page--src--pages--contact-vue.a24e3f68.js"><link rel="prefetch" href="/assets/js/page--src--pages--darkroom-vue.bcb4392b.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.7697d763.js"><link rel="prefetch" href="/assets/js/page--src--pages--photography-vue.9b0f340e.js"><link rel="prefetch" href="/assets/js/page--src--pages--programming-vue.3f9593d1.js"><link rel="prefetch" href="/assets/js/page--src--templates--darkroom-vue.b9c091f2.js"><link rel="prefetch" href="/assets/js/page--src--templates--photography-vue.d6d9eae3.js"><link rel="stylesheet" href="/assets/css/0.styles.d56c1449.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="layout" data-v-1b0d995a><header class="header" data-v-1b0d995a><h1 data-v-1b0d995a><a href="/" class="active" data-v-1b0d995a>Joshua Rainbow</a></h1><hr data-v-1b0d995a><nav class="nav" data-v-1b0d995a><ul data-v-1b0d995a><li data-v-1b0d995a><a href="/photography/" data-v-1b0d995a>Photography</a></li><li data-v-1b0d995a><a href="/programming/" class="active" data-v-1b0d995a>Programming</a></li><li data-v-1b0d995a><a href="/darkroom/" data-v-1b0d995a>Darkroom</a></li></ul></nav></header><content data-v-1b0d995a><h1 data-v-1b0d995a><a href="/programming" class="link router-link-active">Project</a>: 
      Last.fm Tag Cloud Generator
  </h1><p v-if="true" data-v-1b0d995a>Available on <a href="https://github.com/TheTeaCat/lastfm-tag-cloud" data-v-1b0d995a>GitHub</a></p><div id="content" data-v-1b0d995a><h1 id="lastfm-tag-cloud"><a href="#lastfm-tag-cloud" aria-hidden="true"><span class="icon icon-link"></span></a>lastfm-tag-cloud</h1>
<p>A last.fm tag cloud generator built with Vue!</p>
<p>Give it a whirl: <a href="https://theteacat.github.io/lastfm-tag-cloud/" target="_blank" rel="nofollow noopener noreferrer">theteacat.github.io/lastfm-tag-cloud/</a></p>
<h2 id="how-are-the-tags-chosen--scaled"><a href="#how-are-the-tags-chosen--scaled" aria-hidden="true"><span class="icon icon-link"></span></a>How are the tags chosen &#x26; scaled?</h2>
<p>Initially, the sample of artists (up to the size and of the time period you specify) is iterated through. For each artist, their top tags are fetched, using <a href="https://www.last.fm/api/show/artist.getTopTags" target="_blank" rel="nofollow noopener noreferrer">artist.getTopTags</a>. </p>
<p>Each tag in the response has a <code>count</code> for that artist.</p>
<blockquote>
<p><strong>Note:</strong> This <code>count</code> doesn't seem to be documented anywhere. They cap out at 100, so I am working under the assumption that they're a kind of confidence % as to how apropriate that tag is for that artist.</p>
</blockquote>
<p>For each tag on the artist, the tag's <code>count</code> is added to that tag's <code>library_total</code> metric.</p>
<p>This <code>library_total</code> metric is created with an initial value of <code>0</code> for every tag.</p>
<p>Once all of the artists are iterated through, the tags are pruned to the top 100 by this <code>library_total</code> metric. This is done to avoid hitting rate limits on the last.fm API in the next step, where I have to call <a href="https://www.last.fm/api/show/tag.getInfo" target="_blank" rel="nofollow noopener noreferrer">tag.getInfo</a> for every tag.</p>
<p>Each of these 100 tags is then scored as per the following code snippet [<a href="https://github.com/TheTeaCat/lastfm-tag-cloud/blob/master/src/assets/js/Generator.js" target="_blank" rel="nofollow noopener noreferrer">source</a>]:</p>
<pre><code class="language-javascript">score_tags(result){
    for (var tag of result.tags) {
        result.scores[tag] = 0
        /**First, each tagging is weighted by the product of:
         *  - How many times the user has listened to the artist on which the tag was used,
         * and...
         *  - The "count" of that tag on the artist.
         *    I am assuming that this "count" is a confidence % given by last.fm as to the accuracy of the tag on that artist.
         *    I can't find any doccumentation, but this would make sense, as they cap out at 100.
         */
        for (var tagging of result.taggings[tag]) {
            result.scores[tag] += tagging.count/100 * result.listens[tagging.artist]
        }
        /**The sum of all these weighted taggings is then scaled by:
         * 1. How many of the uses of that tag overall fall within the user's library sample (its "uniqueness" to the sample).
         * 
         * 2. How many artists within the sample are tagged with that tag (its "spread" over the sample).
         * 
         * 3. The base 10 logarithm of how many people have used that tag overall (its "reach"; see last.fm API docs).
         *    Base 10 is used so 100 people using the tag makes it twice as significant as 10 people using the tag; a nice balance.
         *    It's also conveniently provided as a function by Math.
         */
        result.scores[tag] = result.scores[tag] 
                                    * (result.tag_meta[tag].library_total / result.tag_meta[tag].total) 
                                    * result.taggings[tag].length * result.taggings[tag].length
                                    * Math.log10(result.tag_meta[tag].reach)
    }
}
</code></pre>
<p><code>tag_meta[tag].total</code> is the <code>taggings</code> metric for that tag, taken from <a href="https://www.last.fm/api/show/tag.getInfo" target="_blank" rel="nofollow noopener noreferrer">tag.getInfo</a>.</p>
<p><code>taggings[tag]</code> is an array of all the artists that were tagged that tag.</p>
<p><code>tag_meta[tag].reach</code> is the <code>reach</code> metric for that tag, taken from <a href="https://www.last.fm/api/show/tag.getInfo" target="_blank" rel="nofollow noopener noreferrer">tag.getInfo</a>.</p>
<p>I've tried to make this take into account the "uniqueness" of the tag to a user's library, as if they were all just scored by frequency the biggest tag on everyone's clouds would probably just be "all".</p>
<p>If this causes issues for you, I know. See <a href="https://github.com/TheTeaCat/lastfm-tag-cloud/issues/10" target="_blank" rel="nofollow noopener noreferrer">here</a>. I don't care. :rowboat:</p>
<h2 id="what-does-the-tag-filter-do"><a href="#what-does-the-tag-filter-do" aria-hidden="true"><span class="icon icon-link"></span></a>What does the tag filter do?</h2>
<p>The tag filter checks tags against an offensive word list, "all", "seen live" and a geohash filter to remove tags that are overly generic/obscene.</p>
<p>The source of the tag filter's offensive word list is <a href="https://www.ofcom.org.uk/__data/assets/pdf_file/0022/91624/OfcomOffensiveLanguage.pdf" target="_blank" rel="nofollow noopener noreferrer">Ofcom's September 2016 Attitudes to potentially offensive language and gestures on TV and radio research report</a>. Those used are the medium, strong, and stronger words that are <strong>not</strong> marked as "least recognised".</p>
<h2 id="acknowledgements"><a href="#acknowledgements" aria-hidden="true"><span class="icon icon-link"></span></a>Acknowledgements</h2>
<p>I'm using <a href="https://github.com/timdream/wordcloud2.js/" target="_blank" rel="nofollow noopener noreferrer">timdream's word cloud generator</a>.</p>
</div></content><footer data-v-1b0d995a><a href="/contact/" data-v-1b0d995a>Contact Me</a></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"programming":{"id":"d24d249c7fa55ecd9efe3bcb2e5b1296","title":"Last.fm Tag Cloud Generator","github":"https:\u002F\u002Fgithub.com\u002FTheTeaCat\u002Flastfm-tag-cloud","content":"\u003Ch1 id=\"lastfm-tag-cloud\"\u003E\u003Ca href=\"#lastfm-tag-cloud\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Elastfm-tag-cloud\u003C\u002Fh1\u003E\n\u003Cp\u003EA last.fm tag cloud generator built with Vue!\u003C\u002Fp\u003E\n\u003Cp\u003EGive it a whirl: \u003Ca href=\"https:\u002F\u002Ftheteacat.github.io\u002Flastfm-tag-cloud\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Etheteacat.github.io\u002Flastfm-tag-cloud\u002F\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Ch2 id=\"how-are-the-tags-chosen--scaled\"\u003E\u003Ca href=\"#how-are-the-tags-chosen--scaled\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EHow are the tags chosen &#x26; scaled?\u003C\u002Fh2\u003E\n\u003Cp\u003EInitially, the sample of artists (up to the size and of the time period you specify) is iterated through. For each artist, their top tags are fetched, using \u003Ca href=\"https:\u002F\u002Fwww.last.fm\u002Fapi\u002Fshow\u002Fartist.getTopTags\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Eartist.getTopTags\u003C\u002Fa\u003E. \u003C\u002Fp\u003E\n\u003Cp\u003EEach tag in the response has a \u003Ccode\u003Ecount\u003C\u002Fcode\u003E for that artist.\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E\u003Cstrong\u003ENote:\u003C\u002Fstrong\u003E This \u003Ccode\u003Ecount\u003C\u002Fcode\u003E doesn't seem to be documented anywhere. They cap out at 100, so I am working under the assumption that they're a kind of confidence % as to how apropriate that tag is for that artist.\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003EFor each tag on the artist, the tag's \u003Ccode\u003Ecount\u003C\u002Fcode\u003E is added to that tag's \u003Ccode\u003Elibrary_total\u003C\u002Fcode\u003E metric.\u003C\u002Fp\u003E\n\u003Cp\u003EThis \u003Ccode\u003Elibrary_total\u003C\u002Fcode\u003E metric is created with an initial value of \u003Ccode\u003E0\u003C\u002Fcode\u003E for every tag.\u003C\u002Fp\u003E\n\u003Cp\u003EOnce all of the artists are iterated through, the tags are pruned to the top 100 by this \u003Ccode\u003Elibrary_total\u003C\u002Fcode\u003E metric. This is done to avoid hitting rate limits on the last.fm API in the next step, where I have to call \u003Ca href=\"https:\u002F\u002Fwww.last.fm\u002Fapi\u002Fshow\u002Ftag.getInfo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Etag.getInfo\u003C\u002Fa\u003E for every tag.\u003C\u002Fp\u003E\n\u003Cp\u003EEach of these 100 tags is then scored as per the following code snippet [\u003Ca href=\"https:\u002F\u002Fgithub.com\u002FTheTeaCat\u002Flastfm-tag-cloud\u002Fblob\u002Fmaster\u002Fsrc\u002Fassets\u002Fjs\u002FGenerator.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Esource\u003C\u002Fa\u003E]:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-javascript\"\u003Escore_tags(result){\n    for (var tag of result.tags) {\n        result.scores[tag] = 0\n        \u002F**First, each tagging is weighted by the product of:\n         *  - How many times the user has listened to the artist on which the tag was used,\n         * and...\n         *  - The \"count\" of that tag on the artist.\n         *    I am assuming that this \"count\" is a confidence % given by last.fm as to the accuracy of the tag on that artist.\n         *    I can't find any doccumentation, but this would make sense, as they cap out at 100.\n         *\u002F\n        for (var tagging of result.taggings[tag]) {\n            result.scores[tag] += tagging.count\u002F100 * result.listens[tagging.artist]\n        }\n        \u002F**The sum of all these weighted taggings is then scaled by:\n         * 1. How many of the uses of that tag overall fall within the user's library sample (its \"uniqueness\" to the sample).\n         * \n         * 2. How many artists within the sample are tagged with that tag (its \"spread\" over the sample).\n         * \n         * 3. The base 10 logarithm of how many people have used that tag overall (its \"reach\"; see last.fm API docs).\n         *    Base 10 is used so 100 people using the tag makes it twice as significant as 10 people using the tag; a nice balance.\n         *    It's also conveniently provided as a function by Math.\n         *\u002F\n        result.scores[tag] = result.scores[tag] \n                                    * (result.tag_meta[tag].library_total \u002F result.tag_meta[tag].total) \n                                    * result.taggings[tag].length * result.taggings[tag].length\n                                    * Math.log10(result.tag_meta[tag].reach)\n    }\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E\u003Ccode\u003Etag_meta[tag].total\u003C\u002Fcode\u003E is the \u003Ccode\u003Etaggings\u003C\u002Fcode\u003E metric for that tag, taken from \u003Ca href=\"https:\u002F\u002Fwww.last.fm\u002Fapi\u002Fshow\u002Ftag.getInfo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Etag.getInfo\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ccode\u003Etaggings[tag]\u003C\u002Fcode\u003E is an array of all the artists that were tagged that tag.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ccode\u003Etag_meta[tag].reach\u003C\u002Fcode\u003E is the \u003Ccode\u003Ereach\u003C\u002Fcode\u003E metric for that tag, taken from \u003Ca href=\"https:\u002F\u002Fwww.last.fm\u002Fapi\u002Fshow\u002Ftag.getInfo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Etag.getInfo\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EI've tried to make this take into account the \"uniqueness\" of the tag to a user's library, as if they were all just scored by frequency the biggest tag on everyone's clouds would probably just be \"all\".\u003C\u002Fp\u003E\n\u003Cp\u003EIf this causes issues for you, I know. See \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FTheTeaCat\u002Flastfm-tag-cloud\u002Fissues\u002F10\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehere\u003C\u002Fa\u003E. I don't care. :rowboat:\u003C\u002Fp\u003E\n\u003Ch2 id=\"what-does-the-tag-filter-do\"\u003E\u003Ca href=\"#what-does-the-tag-filter-do\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EWhat does the tag filter do?\u003C\u002Fh2\u003E\n\u003Cp\u003EThe tag filter checks tags against an offensive word list, \"all\", \"seen live\" and a geohash filter to remove tags that are overly generic\u002Fobscene.\u003C\u002Fp\u003E\n\u003Cp\u003EThe source of the tag filter's offensive word list is \u003Ca href=\"https:\u002F\u002Fwww.ofcom.org.uk\u002F__data\u002Fassets\u002Fpdf_file\u002F0022\u002F91624\u002FOfcomOffensiveLanguage.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EOfcom's September 2016 Attitudes to potentially offensive language and gestures on TV and radio research report\u003C\u002Fa\u003E. Those used are the medium, strong, and stronger words that are \u003Cstrong\u003Enot\u003C\u002Fstrong\u003E marked as \"least recognised\".\u003C\u002Fp\u003E\n\u003Ch2 id=\"acknowledgements\"\u003E\u003Ca href=\"#acknowledgements\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EAcknowledgements\u003C\u002Fh2\u003E\n\u003Cp\u003EI'm using \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ftimdream\u002Fwordcloud2.js\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Etimdream's word cloud generator\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n"}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.9b9312ea.js" defer></script><script src="/assets/js/page--src--templates--programming-vue.c0a9bcf3.js" defer></script>
  </body>
</html>
